# Configuration

Этот раздел содержит множество подразделов, посвященных настройке каждого аспекта Asterisk. Помимо того, что описано в разделе [Core Configuration](#core-configuration), большинство особенностей и функций предоставляются модулями, которые могут быть установлены или не установлены в системе Asterisk. Встроенная документация по конфигурации для каждого модуля (который имеет документацию) может быть доступна через [CLI Asterisk](operation.md#asterisk-command-line-interface). В разделе [CLI Syntax and Help Commands](operation.md#cli-syntax-and-help-commands) содержатся дополнительные сведения о доступе к справке по конфигурации модуля.

## Core Configuration

The sub-pages here cover any possible configuration of Asterisk's core. That is, functionality which is not separated out into modules.
If you are unfamiliar with the core and modules concepts, take a look at the Asterisk Architecture section.

## Channel Drivers

Все об Asterisk и драйверах каналов

### SIP

Раздел в разработке

Раздел для хранения информации о настройке драйверов каналов SIP: chan_sip и chan_pjsip

#### Configuring chan_sip

#### Configuring res_pjsip

##### Configuring res_pjsip for Presence Subscriptions

Раздел в разработке - эта страница не завершена!

###### Возможности

Драйвер канала pjsip Asterisk предоставляет те же возможности подписки на присутствие что и `chan_sip`. Это означает, что присутствие [RFC 3856](http://tools.ietf.org/html/rfc3856) и [RFC4235](http://www.rfc-editor.org/rfc/rfc4235.txt) поддерживаются диалоговые данные. Подписки на присутствие поддерживают тела [RFC 3863](https://tools.ietf.org/html/rfc3863) PIDF+XML, а также [XPIDF+XML](https://tools.ietf.org/html/draft-rosenberg-impp-pidf-00). Кроме того, Asterisk также поддерживает подписку на списки ресурсов присутствия [RFC 4662](https://tools.ietf.org/html/rfc4662).

###### Конфигурация

Если вы знакомы с настройкой подписок в `chan_sip`, то это должно быть вам знакомо. Настройка присутствия выполняется с использованием приоритета "hint" для расширения в `extensions.conf`.

```
; extensions.conf
[default]
exten => 1000,hint,PJSIP/alice
```

Строка, показанная здесь, похожа на любую нормальную строку в диалплане, за исключением того, что вместо номера приоритета или метки указано слово "hint". hint используется для связи состояния отдельных устройств с состоянием расширения диалплана. Английский перевод строки диалплана будет звучать так: "используйте состояние устройства PJSIP/alice в качестве основы для состояния расширения 1000". Когда конечные точки PJSIP подписываются на присутствие, они подписываются на состояние расширения в диалплане. Предоставляя hint (подсказку) в диалплане вы создаете необходимую ассоциацию, чтобы узнать, какое устройство (или устройства) являются релевантными. Для примера, приведенного выше, это означает, что если кто-то подписывается на состояние расширения 1000, то ему будет сообщено состояние PJSIP/alice. Дополнительные сведения о состоянии устройства см. на [этой странице](fundamentals.md#device-state).

Существует два варианта конечных точек, влияющих на наличие подписок в `pjsip.conf`. Параметр `allow_subscribe` определяет, разрешено ли Asterisk получать запросы на подписку от конечной точки. По умолчанию функция `allow_subscribe` включена. Другим параметром, влияющим на подписку на присутствие, является параметр `context`. Этот параметр используется для определения контекста диалплана, в котором следует искать подписываемое расширение. Учитывая приведенный выше фрагмент диалплана, если конечная точка, которая подписывается на расширение 1000, должна подписаться на подсказку 1000@default, то контекст подписывающейся конечной точки должен быть установлен в "default". Обратите внимание, что если параметр `context` имеет значение, отличное от "default", то Asterisk будет искать подсказку в том контексте.

Для правильной работы подписок на присутствие необходимо загрузить некоторые модули. Вот список необходимых модулей:
* `res_pjsip.so`: Ядро кода PJSIP в Asterisk.
* `res_pjsip_pubsub.so`: код, реализующий логику SUBSCRIBE/NOTIFY, на основе которой строятся отдельные обработчики событий.
* `res_pjsip_exten_state.so`: обрабатывает события "presence" и "dialog".
* `res_pjsip_pidf_body_generator.so`: этот модуль генерирует тела сообщений application/pidf+xml. Требуется для большинства подписок на событие "presence".
* `res_pjsip_xpidf_body_generator.so`: этот модуль генерирует тела сообщений application/xpidf+xml. Требуется для некоторых подписок на событие "presence".
* `res_pjsip_dialog_info_body_generator.so`: требуется для подписки на событие "dialog". Этот модуль генерирует тела сообщений application/dialog-info.

Если вы не уверены какое событие или какой тип тела используется вашим устройством для подписки на присутствие, обратитесь к руководству производителя устройства для получения дополнительной информации.

###### Кастомизация присутствия

**Digium Presence**

Телефоны Digium оснащены пользовательским дополнением к базовому формату присутствия PIDF+XML, которое позволяет понимать присутствие XMPP-типа. Чтобы добавить его, hint необходимо изменить, включив в него дополнительное состояние присутствия, например:

```
; extensions.conf
[default]
exten => 1000,hint,PJSIP/alice,CustomPresence:alice
```

Это означает, что обновления состояния присутствия CustomPresence:alice также будут передаваться подписчикам на расширение 1000. Дополнительные сведения о состоянии присутствия в Asterisk см. в разделе на [этой странице](presence-state).

Модуль `res_pjsip_pidf_digium_body_supplement.so` должен быть загружен, чтобы сообщать дополнительные сведения о присутствии.

**Расширенный Presence (ограничено)**

Некоторые расширенные дополнения присутствия, которые были в `chan_sip`, также были перенесены в драйвер канала PJSIP. Это крайне ограниченная реализация "деятельностного" элемента личности. Модуль `res_pjsip_pidf_eyebeam_body_supplement.so` необходим для добавления этой функциональности.

### Inter-Asterisk eXchange protocol, version 2 (IAX2)
### DAHDI
### Local Channel
### Motif
### mISDN
### Mobile Channel
### Unistim
### Skinny
### RTP Packetization

## Dialplan
## Features
## Applications
## Functions
## Reporting
## Interfaces
